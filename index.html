<!DOCTYPE html>
<html lang="id">
<head>
  </head>
<body>
  <div class="container">
    <h3>Formulir Submit Soal PSAS</h3>
    <form id="submissionForm">
          </form>
    <div id="responseMessage" class="message"></div>
  </div>

  <script>
    function showMessage(type, text) {
      // ... (Fungsi showMessage) ...
    }

    document.getElementById('submissionForm').addEventListener('submit', e => {
      e.preventDefault();
      
      const form = e.target;
      const submitButton = document.getElementById('submitButton');
      const file = document.getElementById('uploadedFile').files[0];
      
      if (!file) {
        return showMessage('error', 'File Kisi-kisi wajib diunggah.');
      }
      
      submitButton.disabled = true;
      showMessage('', '⏳ Mengirim data...');

      const reader = new FileReader();
      reader.onload = function(evt) {
        const formData = {
          namaGuru: form.namaGuru.value,
          kelas: form.kelas.value,
          mataPelajaran: form.mataPelajaran.value,
          linkMateri: form.linkMateri.value,
          fileName: file.name,
          fileData: evt.target.result.split(',')[1] 
        };
        
        const successHandler = (res) => {
          showMessage('success', '✅ ' + res);
          form.reset(); 
          submitButton.disabled = false;
        };

        const failureHandler = (err) => {
          showMessage('error', '❌ ' + err.message);
          submitButton.disabled = false; 
        };

        google.script.run
          .withSuccessHandler(successHandler)
          .withFailureHandler(failureHandler)
          .uploadData(formData);
      };
      
      reader.readAsDataURL(file);
    });
  </script>
</body>
</html>
